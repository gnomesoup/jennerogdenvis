---
title: "Jenner-Ogden Data Visualization"
output: html_document
---

This is an R Markdown document. Markdown is a simple formatting syntax for authoring HTML, PDF, and MS Word documents. For more details on using R Markdown see <http://rmarkdown.rstudio.com>.

When you click the **Knit** button a document will be generated that includes both content as well as the output of any embedded R code chunks within the document. You can embed an R code chunk like this:
```{r boundaries, echo=F}
library(rgdal);library(ggplot2); library(dplyr)
bound <- readOGR("./Boundaries", "CPS_Elementary_School_Attendance_Boundaries_SY1415")
bound <- spTransform(bound, CRS("+proj=longlat +datum=WGS84"))
schools <- data.frame(SchoolName = bound$SchoolName, SchoolID = bound$SchoolID, SchoolAddr = bound$SchoolAddr)
boundplot <- fortify(bound)
ogdenIndex <- grep("OGDEN", schools$SchoolName) - 1
jennerIndex <- grep("JENNER", schools$SchoolName) - 1
ogden <- boundplot %>% filter(id == ogdenIndex)
ogden$SchoolName <- "Ogden"
jenner <- boundplot %>% filter(id == jennerIndex)
jenner$SchoolName <- "Jenner"
jenog <- rbind(ogden, jenner)
x <- c(min(jenog$long), max(jenog$long))
y <- c(min(jenog$lat), max(jenog$lat))
schoolLoc <- data.frame(SchoolName = c("Jenner", "Ogden East", "Ogden West"),
                        long = c(-87.640825, -87.629096, -87.660443),
                        lat = c(41.902122, 41.900282, 41.891817))
```

```{r, echo=FALSE}
library(ggmap); library(wesanderson)
map <- get_map(location=c(lon = -87.638, lat = 41.895), zoom = 14, maptype="roadmap")
chi <- ggmap(map)
eMap <- chi + geom_polygon(aes(x=as.nulong, y=lat, group=group), fill=grey, size = 2, color='black', data=bound, alpha=0)
eMap
```

```{r}
library(ggplot2); library(wesanderson)
pal <- wes_palette("Moonrise3")
p <- ggplot(rbind(ogden, jenner)) + 
  aes(long, lat, group=group, fill=SchoolName) + 
  geom_polygon() + geom_path (color = 'white', size = 1) +
  scale_fill_manual(values = pal) + 
  coord_fixed(ratio=1) +
  theme(aspect.ratio = 1) +
  geom_point(data=schoolLoc, aes(long, lat), size = 5,
                    colour = pal[3], inherit.aes=F, show_guide=F)
schoolLoc$labels <- paste0("  ", schoolLoc$SchoolName)
p <- p + geom_text(data=schoolLoc, aes(long,lat,label=labels),
                   hjust=0, angle=0, show_guide=FALSE, inherit.aes=F)
p
```

```{r crime, echo=FALSE}
library(readr); library(lubridate)
dir.create("crime", showWarnings=F)
crime <- read.csv("./crime/Crimes_-_2001_to_present.csv")
crime <- crime %>% filter(Year == "2015") %>% filter(!is.na(Latitude))
```

